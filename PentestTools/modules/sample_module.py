import argparse
from PentestTools.result import TestResult

#Name your Check
check_name = "Sample Check"

def parse_args(args):
    parser = argparse.ArgumentParser(description='Example Module')
    # Standard Parameters (DO NOT MODIFY)
    parser.add_argument('-t', '--target', required=True, help='Target IP address')    
    # Custom Argument (CUSTOMIZE TO YOUR MODULE's NEEDS)
    parser.add_argument('-v', '--verbose', required=False, help='Verbose output, useful for debugging')    
    return parser.parse_args(args)

def run(args):
    parsed_args = parse_args(args)
    
    print(f"Running example module against target: {parsed_args.target}")
    # Perform the test then store results in results below
    # each item will have
    # target: the target IP address
    # status: success or fail
    # details: a dictionary with details
    results = [TestResult(target=parsed_args.target, check=check_name, status="success", details={"example": "data"})]
    return results
